<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>White Page – Editor.js Prototype</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { width:100%; height:100%; background:#fff; color:#222; font-family:'IBM Plex Sans', system-ui, sans-serif; line-height:1.7; }
  main { max-width: 850px; margin: 4rem auto; padding: 0 1.5rem; }
  .back-placeholder { position:fixed; top:1.5rem; left:1.5rem; font-size:.9rem; color:#888; opacity:.6; user-select:none; }

  /* View container */
  #content-view img { width:100%; height:auto; display:block; border-radius:6px; margin:2rem 0; }
  #content-view iframe { width:100%; aspect-ratio:16/9; border:0; display:block; margin:2rem 0; }
  #content-view audio { width:100%; display:block; margin:2rem 0; }
  #content-view h1 { text-align:center; font-size:clamp(1.8rem,3vw,3rem); margin-bottom:.5rem; }
  #content-view h2 { text-align:center; color:#555; font-weight:400; margin-bottom:2rem; }
  #content-view p { margin: 1.5rem 0; font-size: clamp(1rem,1.2vw,1.15rem); }
  #content-view hr { border:none; border-top:1px solid #ddd; margin:3rem 0; }

  /* Editor overlay */
  #editor-wrap { display:none; position:relative; max-width: 850px; margin: 4rem auto; padding: 0 1.5rem; }
  #editorjs { background:#fff; border:1px dashed #ccc; border-radius:8px; padding:16px; }
  .editor-toolbar {
    position: sticky; top: 0; display:flex; gap:8px; justify-content:flex-end;
    background: #fff; padding-bottom:8px; margin-bottom:8px; z-index:5; border-bottom:1px solid #eee;
  }
  .editor-toolbar button {
    font: inherit; font-weight:600;
    padding: 6px 10px; border:1px solid #ccc; border-radius:6px; cursor:pointer; background:#f9f9f9;
  }

  /* White build-in transition */
  #white-transition { position:fixed; inset:0; background:#000; display:grid; grid-template-columns:repeat(auto-fill,minmax(60px,1fr)); grid-auto-rows:60px; z-index:9999; }
  .white-block { background:#fff; opacity:0; transition:none; }
</style>
</head>
<body>
  <div id="white-transition"></div>
  <div class="back-placeholder">[Back]</div>

  <main>
    <!-- View Mode -->
    <div id="content-view"></div>

    <!-- Edit Mode -->
    <div id="editor-wrap">
      <div class="editor-toolbar">
        <button id="load-sample">Load Sample</button>
        <button id="save-btn">Save</button>
        <button id="exit-btn">Exit</button>
      </div>
      <div id="editorjs"></div>
    </div>

    <div style="text-align:right; margin-top:1rem;">
      <button id="edit-toggle" title="Ctrl+E">Edit</button>
    </div>
  </main>

  <!-- Editor.js and tools (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/simple-image@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/raw@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/editorjs-html@latest/build/edjsHTML.umd.js"></script>

<script>
/* ---------- White build-in transition ---------- */
document.addEventListener("DOMContentLoaded", () => {
  const c = document.getElementById("white-transition");
  const cols = Math.ceil(window.innerWidth / 60);
  const rows = Math.ceil(window.innerHeight / 60);
  const total = cols * rows;
  for (let i = 0; i < total; i++) {
    const b = document.createElement("div"); b.className = "white-block"; c.appendChild(b);
  }
  const blocks = Array.from(c.children).sort(() => Math.random() - 0.5);
  let i = 0, step = 25;
  const interval = setInterval(() => {
    for (let j = 0; j < step && i < blocks.length; j++, i++) blocks[i].style.opacity = 1;
    if (i >= blocks.length) {
      clearInterval(interval);
      setTimeout(() => { c.style.transition = "opacity .3s ease-out"; c.style.opacity = 0; setTimeout(() => c.remove(), 400); }, 150);
    }
  }, 25);
});

/* ---------- Editor.js setup ---------- */
let editor;
const STORAGE_KEY = 'white_page_editor_data';

const initialData = {
  time: Date.now(),
  blocks: [
    { type: 'header', data: { text: 'Reflections on Paint and Light', level: 1 } },
    { type: 'paragraph', data: { text: 'Exploring texture, tone, and sound in motion' } },
    { type: 'paragraph', data: { text: 'Every image carries a rhythm—an undercurrent of balance and contrast. When I began this project, I wanted to explore what happens when those visual rhythms meet sound. This post collects fragments: a mix of textures, stills, and the hum of a place coming alive.' } },
    { type: 'simpleImage', data: { url: 'my_assets/MoonTexture.jpg', caption: 'Sample photograph of texture and light', withBorder: false, withBackground: false, stretched: false } },
    { type: 'paragraph', data: { text: 'The scene above was captured at dusk, when the surface reflections started to blur. I’ve found that soft light is less about clarity and more about patience. Waiting for the right moment means letting the world slow down with you.' } },
    { type: 'embed', data: { service: 'youtube', source: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ', embed: 'https://www.youtube.com/embed/dQw4w9WgXcQ', width: 580, height: 320, caption: 'Sample video embed' } },
    { type: 'paragraph', data: { text: 'Video, unlike stills, carries the weight of time. In the clip above, movement is the message: repetition, silence, and return. Audio becomes part of the composition.' } },
    // Raw block lets you paste any HTML (e.g., <audio> player)
    { type: 'raw', data: { html: '<audio controls><source src="my_assets/doorbell.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio>' } },
    { type: 'paragraph', data: { text: 'Listening while watching changes what we see. Texture turns into rhythm. Color becomes tempo. That’s why I consider each medium a translation—one sense learning from another.' } },
    { type: 'delimiter' },
    { type: 'paragraph', data: { text: 'Future updates to this space will blend formats even further: written pieces, spoken reflections, photo mosaics, and field recordings. For now, it remains an open page—a blank sheet ready to absorb the next idea.' } }
  ],
  version: '2.29.0'
};

function renderView(data) {
  const edjsParser = edjsHTML();
  const html = edjsParser.parse(data).join('\n');
  document.getElementById('content-view').innerHTML = html;
}

function loadData() {
  const cached = localStorage.getItem(STORAGE_KEY);
  if (cached) {
    try { return JSON.parse(cached); } catch {}
  }
  return initialData;
}

function initEditor(data) {
  if (editor) return;
  editor = new EditorJS({
    holder: 'editorjs',
    autofocus: true,
    data,
    tools: {
      header: { class: Header, inlineToolbar: true, config: { levels: [1,2,3,4], defaultLevel: 2 } },
      list: { class: List, inlineToolbar: true },
      simpleImage: { class: SimpleImage, inlineToolbar: true },
      embed: { class: Embed, inlineToolbar: true, config: { services: { youtube: true, vimeo: true } } },
      raw: { class: RawTool }
    },
    onReady: () => {/* no-op */},
    onChange: () => {/* live changes handled on save */},
  });
}

function enterEdit() {
  document.getElementById('content-view').style.display = 'none';
  document.getElementById('editor-wrap').style.display = 'block';
  initEditor(loadData());
}
function exitEdit() {
  document.getElementById('editor-wrap').style.display = 'none';
  document.getElementById('content-view').style.display = 'block';
}

document.getElementById('edit-toggle').addEventListener('click', enterEdit);
document.addEventListener('keydown', (e)=>{ if (e.ctrlKey && e.key === 'e') { e.preventDefault(); enterEdit(); } });

document.getElementById('exit-btn').addEventListener('click', exitEdit);
document.getElementById('load-sample').addEventListener('click', ()=>{
  if (editor) {
    editor.render(initialData);
  }
});

document.getElementById('save-btn').addEventListener('click', async ()=>{
  const output = await editor.save();
  // cache for in-progress work
  localStorage.setItem(STORAGE_KEY, JSON.stringify(output));
  // render the new HTML
  renderView(output);
  // show in console for copy/paste to your repo
  console.log('--- Editor.js JSON ---\\n', JSON.stringify(output, null, 2));
  exitEdit();
});

// initial render
renderView(loadData());
</script>
</body>
</html>
